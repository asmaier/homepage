<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

</head>

<body>

<h5>Tipps zum Drucken unter Linux</h5>
<p>Beim Drucken zeigen sich die Stärken und Schwächen des Betriebssystems
ganz besonders. Die Treiberunterstützung ist im Vergleich zu Windows
oft noch schlecht und die Installation und Einrichtung von lokalen Druckern ist
unter Linux manchmal immer noch ein unnötig komplizierter Vorgang.
Hat jedoch ein fähiger Administrator einen CUPS-Server eingerichtet,
ist die Einrichtung und Nutzung von Netzwerkdruckern ganz im Gegensatz zu Windows
ein Kinderspiel. Zur Druckersteuerung unter Linux verwendet man häufig noch
kryptische Kommandozeilen, die jedoch, wenn man sie einmal gelernt hat,
dann wieder ein wesentlich schnelleres Arbeiten ohne Überraschungen
erlaubt.</p>

<h6>Drucken unter CUPS</h6>
<p>Benutzt man das Common Unix Printing System (CUPS), so kann man viele
Einstellungen und Informationen zum Druckvorgang über den Webbrowser
bekommen. Folgende Adressen ([cupsserver] steht für die IP-Adresse
des CUPS-Servers, z.B. <tt>192.168.0.2</tt> oder 
bei lokaler Installation <tt>localhost</tt>) sind u.a. nützlich:</p>
<ul>
<li><em>Bedienung über HTML allgemein:</em>
<pre>
http://[cupsserver]:631/
</pre></li>
<li><em>Anleitung zu CUPS-Bedienung</em>
<pre>
http://[cupsserver]:631/sum.html
</pre></li>
<li><em>Laufende Jobs:</em>
<pre>
http://[cupsserver]:631/jobs
</pre></li>
<li><em>vorhandene bzw. eingerichtete Drucker:</em>
<pre>
http://[cupsserver]:631/printers
</pre></li>
</ul>
<p>Das CUPS erweitert auch die Steuerungsmöglichkeiten des Druckvorgangs
über die Kommandozeile. Einige nützliche Optionen sind u.a.:</p>
<ul>
<li><em>nur bestimmte Seiten drucken:</em>
<pre>
> lpr -o page-ranges=1-4,7,9-12 dateiname
</pre>
Mit diesem Kommando werden nur die Seiten 1-4,7 und 9-12 der Datei
<tt>dateiname</tt> gedruckt. Zu beachten ist, dass die Seitenangabe
hier meist nicht mit der Seitennummerierung innerhalb der Datei übereinstimmt,
z.B. wenn das Titelblatt die Seitennummer 0 hat.
</li>
<li><em>mehrere Seiten auf ein Blatt drucken:</em>
<pre>
> lpr -o number-up=4 -o number-up-layout=tblr dateiname
</pre>
Hiermit werden vier Seiten auf ein Blatt gedruckt. Die Option
<tt>number-up-layout</tt> gibt dabei an, in welcher Reihenfolge
die einzelnen Seiten auf das Blatt gedruck werden sollen.
Die Defaulteinstellung ist <tt>lrtb</tt> (left to right, top to bottom),
eine andere Möglichkeit ist das im Beispiel verwendete
<tt>tblr</tt> (top to bottom, left to right).
</li>
<li><em>doppelseitig drucken:</em>
<pre>
> lpr -o sides=two-sided-long-edge dateiname
</pre>
Die Option <tt>sides=two-sided-long-edge</tt> gibt dabei an, dass
das doppelseitige Dokument später über die lange Blattkante
geblättert werden soll. Sie macht natürlich nur dann Sinn,
wenn der Drucker auch doppelseitig drucken kann und entsprechend
eingerichtet wurde.
</li>
<li><em>Anzeige der Druckerwarteschlange:</em>
<pre>
> lpq
</pre></li>
<li><em>Druckaufträge aus der Warteschlange löschen:</em>
<pre>
> lprm
</pre>
Dies löscht alle eigenen Druckaufträge, aber nicht die anderer
Benutzer. Will man nur einen bestimmten Druckauftrag löschen,
so muß man dies extra angeben:
<pre>
> lprm -Plp1 42
</pre>
Dies löscht den Druckauftrag Nummer 42 aus der Druckerwarteschlange für
den Drucker <tt>lp1</tt>.
</li>
</ul>

<h6>Poster drucken</h6>
<p>Um Poster oder andere große Bilder einfach auf mehrere Blätter verteilt zu drucken gibt
es für Linux eine einfache Antwort:</p>
<ul>
<li><a href="http://posterazor.sourceforge.net/">Posterazor</a></li>
</ul>
<p>Mit diesem kleinen Programm kann ein beliebiges Bild in ein entsprechendes mehrseitiges
PDF umgewandelt werden, welches man dann mit einem beliebigem PDF-Viewer ausdrucken kann. 
Dabei bietet es intuitive Benutzeroberfläche, so dass man sofort sieht,
wie das Bild auf die verschiedenen Seiten aufgeteilt wird. Das ist wesentlich einfacher
als mit einem Programm, welches nur irgendwelche kryptischen Parameter auf der Kommandozeile
entgegennimmt, wie z.B. bei <a href="http://printing.kde.org/downloads/"><tt>poster</tt></a> der Fall.
Wer es unbedingt doch über die Kommandozeile machen möchte findet bei
<a href="http://issaris.blogspot.com/2006/02/printing-huge-posters.html">Printing huge posters</a>
eine Anleitung, wie man das mit obengenanntem <tt>poster</tt> bewerkstelligt.</p>

<h6>Drucken von DIN A5-Heftchen</h6>
<p>Manchmal ist es praktisch ein Dokument (z.B. die 
<a href="http://www.wvv.de/vvm/fahrplan/fahrplaene/index.html">Würzburger Busfahrpläne</a>)
als DIN A5-Heftchen (d.h. es werden jeweils zwei Seiten auf 
ein DIN A4 Blatt gedruckt und dann so gefaltet, dass ein DIN A5-Heft entsteht)
zu drucken. Dies kann man ganz einfach über den KDE-Druckdialog erreichen
(Leider steht dieser im Acrobat Reader nicht zur Verfügung. PDF-Dokumente sollte
man daher mit KGhostview öffnen.):</p>
<ol>
<li>KDE-Druckdialog öffnen und auf "Eigenschaften" ("Properties") klicken.</li>
<li>Den Karteireiter "Filter" ("filter") auswählen.</li>
<li>Auf das trichterförmige Icon "Filter hinzufügen" ("add filter") klicken.</li>
<li>Hier den Filter "Pamphlet Printing (use with small side duplex printing)" auswählen
und auf "OK" klicken.</li>
<li>Zurück auf den Karteireiter "Allgemein" ("General") klicken und dort unter 
"Beidseitiger Druck" (Duplex Printing") "Schmalseitig" ("short side") auswählen.</li>
<li>Den Dialog mit "OK" abschließen und das Dokument drucken.</li> 
</ol>
<p>Alternativ dazu kann man das ganze auch über die Kommandozeile erreichen.
Dazu ist es notwendig, dass das Paket "psutils" installiert ist (einfach mit YAST2 
überprüfen und gegebenenfalls nachinstallieren). Dann kann man PS-Dokumente
(PDF-Dokumente muß man vorher in PS-Dokumente umwandeln wie 
<a href="convert.html">hier</a> beschrieben.)
mit folgendem Befehl umwandeln:</p>
<pre>
> psbook datei.ps | psnup -2 > datei_A5.ps
</pre>
<p>Der Befehl <tt>psbook</tt> ändert dabei die Reihenfolge der Seiten des PS-Dokuments in
geeigneter Weise und der anschließende Befehl <tt>psnup</tt> generiert ein
PS-Dokument so, dass 2 Seiten des ursprünglichen Dokuments jetzt auf ein Blatt verkleinert
werden. Jetzt kann man das so generierte Dokument ausdrucken:</p>
<pre>
> lpr -o sides=two-sided-short-edge datei_A5.ps
</pre>

<h6>Präsentationen drucken</h6>
<p>Viele Präsentationen sind als PDFs im Querformat erstellt. Um diese platzsparend auszudrucken
kann man folgende Befehlszeile versuchen:</p>
<pre>
> lpr -o number-up=4 -o number-up-layout=lrtb praesentation.pdf
</pre>
<p>Leider funktioniert das nicht immer richtig, da viele PDF-Präsentationen seltsame Seitenformate
verwenden und daher zunächst noch skaliert werden müssen. Eine Lösung ist diese
Präsentationen mit dem Acrobat Reader auszudrucken. Dort muß man dann unter
"Page Scaling: Fit to Printer Margins" auswählen und als "Printer Command"</p>
<pre>
/usr/bin/lpr -P lp1 -o number-up=4 -o number-up-layout=lrtb
</pre>
<p>eintragen.</p>

<h6>Tipps zu a2ps</h6>
<p>Das Programm <tt>a2ps</tt> erlaubt es ASCII-Text "schön" formatiert
auszudrucken. Dies ist besonders zum Ausdrucken von Quellcode nützlich,
da <tt>a2ps</tt> z.B. Kommentare und Schlüsselwörter im Code automatisch erkennt
und diese durch Farbe, Schriftgrad oder Schriftart hervorhebt und damit den
Code erheblich lesbarer gestaltet. Der Vorteil von <tt>a2ps</tt> gegenüber
dem direkten Ausdruck aus einem Editor mit eigener Synaxerkennung heraus
(z.B. Kile für Latex oder Kate für C++) ist, dass es insbesondere für
den Graustufendruck angepasste und optimierte Designs anbietet und
natürlich das <tt>a2ps</tt> aus der Kommandozeile
heraus zu starten immer schneller ist als mühsam einen Editor zu laden,
sich durch die notwendigen Druckeinstellungen zu quälen um schließlich drucken
zu können. Ein großer Nachteil von <tt>a2ps</tt> ist jedoch, dass es 
(noch?) keine UTF8-Kodierung unterstützt (mehr dazu siehe weiter unten).
<br />
Das <tt>a2ps</tt>-Kommando erlaubt eine Unmenge von Optionen. Einige
wichtige zeigt das folgende Beispiel, welches ich als
Alias in meiner <tt>.alias</tt>-Datei definiert habe:</p>
<pre>
alias druck="a2ps --line-numbers=1 -l 100 -T 3 -s 2 -M A4 --delegate=0 -P display"
</pre>
<p>Die Layoutoptionen dabei sind:</p>
<ul>
<li> <em>Zeilennummern einschalten:</em> <tt>--line-numbers=1</tt></li>
<li> <em>Zeilenlänge von 100 Buchstaben:</em> <tt>-l 100</tt> oder <tt>--chars-per-line=100</tt></li>
<li> <em>Tabulatorabstand von 3 Zeichen:</em> <tt>-T 3</tt> oder <tt>--tabsize=3</tt></li>
<li> <em>Zweiseitiger Ausdruck (wenn der Drucker es erlaubt):</em> <tt>-s 2</tt> oder <tt>--sides=duplex</tt></li>
<li> <em>Papierformat DIN A4:</em> <tt>-M A4</tt> oder <tt>--medium=A4</tt></li>
</ul>
<p>Die Option <tt>--delegate=0</tt> verhindert, dass <tt>a2ps</tt> automatisch 
mithilfe externer Programme die übergebenen Dateien in PS-Dateien umzuwandeln
versucht (z.B. möchte es in der Standardeinstellung HTML-Dateien mithilfe von
Netscape in PS-Dateien umzuwandeln). Dies ist meistens nicht gewollt; wenn man 
<tt>a2ps</tt> schon verwendet, dann will man eigentlich immer den Quelltext drucken 
und nicht das gerenderte Ergebnis. <br />
Die Option <tt>-P display</tt> schließlich sorgt dafür, dass <tt>a2ps</tt> das Ergebnis
nicht gleich an den Standarddrucker schickt, sondern zunächst als Vorschau in
<tt>gv</tt> öffnet. Gefällt das Ergebnis kann man es von da aus bequem ausdrucken.
<br />
<em>Druckvorschau mit <tt>kghostview</tt> statt <tt>gv</tt>:</em><br />
In Suse 9.3 wird <tt>gv</tt> nicht mehr standardmäßig installiert und die
Druckvorschau funktioniert mit <tt>a2ps</tt> dementsprechend zunächst nicht.
Will oder kann man das alte <tt>gv</tt> deswegen nicht installieren, so kann man
zur Druckvorschau auch <tt>kghostview</tt> verwenden, wenn man <tt>a2ps</tt>
entsprechend konfiguriert. Dazu sind folgende Schritte nötig:</p>
<ol>
<li> Falls nicht vorhanden im Homeverzeichnis ein Verzeichnis <tt>.a2ps</tt>
anlegen und in diesem eine Datei namens <tt>a2psrc</tt> erzeugen:
<pre>
> mkdir .a2ps
> cd a2ps
> pico a2psrc
</pre></li>
<li>In diese Datei folgende Zeile eintragen:
<pre>
Variable: ghostview kghostview
</pre></li>
</ol>
<p>Das wars. Beim nächsten Start von <tt>a2ps</tt> wird als Vorschau immer 
<tt>kghostview</tt> statt <tt>gv</tt> verwendet. Will man noch andere 
Einstellungen ändern, so empfiehlt es sich als Vorlage die systemweite
Konfigurationsdatei von <tt>a2ps</tt> anzuschauen, welche unter Suse Linux 9.3
unter <tt>/etc/a2ps.cfg</tt> zu finden ist. 
<br />
<em>Weitere Optionen:</em></p>
<ul>
<li><em>Ein bestimmtes Syntaxhighlighting erzwingen:</em>
Manchmal erkennt <tt>a2ps</tt> die verwendete Sytax nicht richtig.
Dies kann man überprüfen durch:
<pre>
> a2ps --guess dateiname
</pre>
Wird dabei eine offensichtlich falsche Syntax erkannt, kann 
man dies mit der <tt>-E</tt>-Option erzwingen. Verwendet man mein obiges Alias,
dann kann man z.B. die Verwendung von Fortran-Syntaxhighlighting für die Datei
"dateiname" erzwingen durch:
<pre>
> druck -Efortran dateiname
</pre>
Weitere Möglichkeiten sind z.B. <tt>-Ec</tt> (C), <tt>-Ecpp</tt> (C++), <tt>-Etex</tt> (Latex).
Sämtliche möglichen Programmiersprachen bzw. Syntax-Stylesheets findet man z.B. 
<a href="http://www.infres.enst.fr/~demaille/a2ps/doc-4.12/a2ps_7.html#SEC69">hier</a>.</li>
<li><em>Farbe erzwingen:</em><br />
Will man ein farbiges statt graues Syntaxhighlighting so kann man dies erreichen durch
<pre>
> druck --prologue=color dateiname
</pre>
Damit wird eine farbige PS-Datei generiert und als Vorschau angezeigt.
</li>
<li><em>Aktuelles Verzeichnis im Kopf der Ausdrucks:</em><br />
In den Standardeinstellungen erscheint der Pfad der ausgedruckten Datei leider
nicht. Aber durch folgende Option kann man das gerade aktive Verzeichnis und damit
auch meist den richtigen Pfad zur Datei im Header des Ausdrucks angeben:
<pre>
> druck --header=$PWD
</pre>
Jedoch erlebt man eine Enttäuschung, wenn man diese Option zusätzlich zu den anderen in einem
Alias definiert. Die <tt>.alias</tt>-datei wird immer beim Start eines neuen
Terminals ausgeführt und somit wird man immer das beim Start des Terminals aktive
Verzeichnis (also meist das eigene Homeverzeichnis) im Kopf der ausgedruckten Datei
finden. Um das gewünschte Ergebnis zu erzielen, muß man stattdessen eine Funktion
(s. auch <a href="shell.html">Tipps zur Shell</a>) in der <tt>.bashrc</tt>-Datei 
wie folgt definieren:
<pre>
druckiso() { druck --header=$PWD $1; }
</pre>
Mithilfe von 
<pre>
> druckiso dateiname
</pre>
ist es dann einfach alle Dateien (zumindest die mit ISO-Encoding) 
schön formatiert auszudrucken.
</li>
<li><em>UTF8-kodierte Dateien ausdrucken:</em><br />
UTF8 wird von <tt>a2ps</tt> leider noch immer nicht unterstützt. Das Einzige was möglich
ist, ist eine UTF8-Datei automatisch in ein Encoding umzuwandeln welches <tt>a2ps</tt>
kennt. Dazu bietet sich z.B. das Tool <tt>iconv</tt> an (andere Möglichkeiten wären
mit dem <tt>recode</tt>-Befehl oder dem <tt>u2ps</tt>-Skript). Ich habe mir dazu folgende
Funktion in der <tt>.bashrc</tt> definiert:
<pre>
druckutf() { iconv -f utf8 -t latin1 $1 | druck --header=$PWD --center-title=$1; }
</pre>
Damit werden alle UTF8-Dateien von <tt>iconv</tt> zunächst in das Latin1-Encoding
konvertiert und die Ausgabe an <tt>a2ps</tt> (bzw. meinen Alias <tt>druck</tt>)
weitergegeben. Die Option <tt>--center-title=$1</tt> ist nötig, da <tt>a2ps</tt>
ansonsten in den Kopf des Ausdrucks nicht den Dateinamen übernimmt.Stattdessen
steht dort <tt>stdin</tt>, da die Ausgabe von <tt>iconv</tt> 
direkt per Pipe <tt>|</tt> an und damit über <tt>stdin</tt> an <tt>a2ps</tt> geht.
</li>
</ul>

<h6>Passwortgeschütztes PDF über die Kommandozeile drucken</h6>
<p>Der offensichtliche Weg über <tt>acroread -toPostScript | lpr</tt> funktioniert nicht,
da es beim Aufruf des Acrobat Readers über die Kommandozeile keine Möglichkeit gibt ein Passwort
zu übergeben. Daher muss man unter Suse Linux erst mit Yast das Paket <tt>xpdf</tt> installieren.
Dieses enthält das Tool <tt>pdftops</tt> mit dem man dann das PDF ausdrucken kann</p>
<pre>
> pdftops -upw [Passwort] Dateiname.pdf - | lpr
</pre>
<p>Dabei steht <tt>-upw</tt> für "user password" und <tt>[Passwort]</tt> sollte durch das entsprechende Passwort ersetzt werden.
Die Angabe von <tt>-</tt> als Ausgabedateinamen bewirkt die Ausgabe in die Standardausgabe <tt>stdout</tt>, welche
dann mit dem Pipe-Kommando <tt>|</tt> in die Standardeingabe des nächsten Befehls (hier <tt>lpr</tt>) weitergeleitet
wird (siehe dazu auch Kapitel 9.3 von 
<a href="http://www.csse.monash.edu.au/software/mil/userguide.html#tth_sEc9.3">Monash Image Library for Linux</a>).
Statt <tt>pdftops</tt> kann man auch <tt>pdf2ps</tt> versuchen, aber letzteres erzeugt viel größere und qualitativ 
schlechtere PS-Dateien.</p>

<h6>Man-Pages ausdrucken</h6>
Angenommen wir wollen die man-page von <tt>rsync</tt> ausdrucken, Dann gibt es drei Möglichkeiten:
<ol>
<li>Umwandlung der man-page in ein PDF:
<pre>
> man -t rsync | ps2pdf - > rsync.pdf
</pre>
Danach kann die Datei über jeden PDF-Anzeiger ausgedruckt werden.
</li>
<li>Umwandlung der man-page in HTML: Dazu unter KDE den Konqueror starten und in die Adresszeile
<tt>man:rsync</tt> eingeben. Dann kann man wie üblich die HTML-Seite mit dem Konqueror ausdrucken.
</li>
<li> Umwandlung der man-page in eine reine Textdatei:
<pre>
> man rsync | col -b > rsync.txt
</pre>
Danach kann die Datei über jeden Texteditor ausgedruckt werden.
</li>
</ol>

</body>
</html>